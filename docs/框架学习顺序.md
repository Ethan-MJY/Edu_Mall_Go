📚 推荐学习顺序

第一阶段：基础设施层（先理解底层依赖）

1️⃣ 数据层 → adaptor/ 目录

架构图：最底层的 "数据层"
├── adaptor/repo/        # 数据库存储
│   ├── query/          # GORM 生成的查询代码
│   └── model/          # GORM 生成的数据模型
└── adaptor/redis/       # Redis 存储
为什么先看这里？ 这是整个系统的数据基础，了解有哪些表、字段、数据结构。

重点关注：
- adaptor/repo/model/ 中的数据模型（对应数据库表结构）
- adaptor/repo/query/ 中的查询方法
- adaptor/redis/ 中的缓存操作封装

  ---
2️⃣ 配置管理 + 工具包 → config/ + utils/

架构图：右侧的 "配置管理" 和 "工具包"
├── config/              # 配置加载（本地文件/etcd）
├── utils/               # 日志、加密、验证码等工具
└── consts/              # 常量定义（架构图的"错误码"部分）
为什么这时看？ 服务层和控制层会大量使用这些工具。

  ---
第二阶段：核心业务层

3️⃣ 领域对象 (DO) → service/do/
DO 对象（Domain Object - 领域对象），DO 是"业务单据"，专门用于在 Service 层（业务逻辑层）内部传递数据。

架构图：服务层下方的紫色 "DO对象"
service/do/              # 领域对象（数据库模型的业务表达）
作用：将数据库模型转换为业务逻辑中使用的对象。

  ---
4️⃣ 服务层 → service/ 目录

架构图：中间的棕色 "服务层" 区域
service/
├── admin/               # 对应架构图中的各业务模块：
/│   ├── user_service.go      # → 管理员模块
│   ├── role_service.go      # → 角色模块
│   ├── perm_service.go      # → 菜单权限模块
│   ├── goods_service.go     # → 商品模块
│   └── order_service.go     # → 订单模块
└── customer/            # 用户前台业务模块
├── user_service.go      # → 用户模块
├── cart_service.go      # → 购物车模块
└── order_service.go     # → 订单模块
核心价值：所有业务逻辑都在这里实现，是整个系统的大脑。

学习建议：
- 先看简单的模块（如用户查询、商品列表）
- 再看复杂的业务流程（如下单流程、订单状态机）

  ---
5️⃣ 数据传输对象 (DTO) → service/dto/
DTO --> Data Transfer Object -- > 数据传输对象，专门用于在前端与后端之间传输数据
作用：
- 安全性：不暴露敏感字段（密码、内部ID等）
- 灵活性：前端只需要什么就返回什么，减少数据传输
- 解耦：前端的字段名可以和数据库字段名不一样

架构图：控制层上方的红色 "DTO对象"
service/dto/             # API 请求和响应的数据结构
作用：定义接口的入参和出参格式。

  ---
第三阶段：接口暴露层

6️⃣ 控制层 → api/ 目录

架构图：棕色 "控制层"
api/
├── admin/               # → 管理后台控制器
│   ├── user_ctrl.go
│   ├── role_ctrl.go
│   ├── goods_ctrl.go
│   └── order_ctrl.go
└── customer/            # → 用户前台控制器
├── user_ctrl.go
├── goods_ctrl.go
├── cart_ctrl.go
└── order_ctrl.go
作用：接收 HTTP 请求，调用 service 层处理，返回响应。

  ---
7️⃣ 路由层 + 中间件 → router/

架构图：最顶层的紫色 "路由层" + 右侧的中间件
router/
├── router.go            # 路由注册（对应架构图的路由层）
├── middleware.go        # 中间件（监权、日志、Recover等）
└── white_list.go        # 白名单配置
作用：定义 URL 路由规则，注册中间件（认证、日志、错误恢复）。

  ---
8️⃣ 启动入口 → main.go

架构图：串联所有层的入口
main.go                  # 初始化 MySQL、Redis、注册路由、启动服务
作用：整个项目的启动流程，依赖注入的入口。

  ---
🎯 快速上手流程（以"查询商品列表"为例）

1. 客户端请求：GET /api/mall/customer/v1/goods/list
   ↓
2. 路由层：router/router.go:115 → 匹配路由
   ↓
3. 中间件：router/middleware.go → 认证中间件
   ↓
4. 控制层：api/customer/goods_ctrl.go → GoodsListHandler
   ↓
5. DTO 解析：service/dto/goods_dto.go → 解析请求参数
   ↓
6. 服务层：service/customer/goods_service.go → 查询业务逻辑
   ↓
7. 数据层：adaptor/repo → 通过 query 查询数据库
   ↓
8. DO 对象：service/do/goods.go → 转换为领域对象
   ↓
9. DTO 响应：service/dto/goods_dto.go → 构造响应数据
   ↓
10. 返回响应：JSON 格式返回给客户端

  ---

这样从底层到上层、从简单到复杂，就能快速掌握整个框架的运作机制了！